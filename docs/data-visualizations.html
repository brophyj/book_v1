<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Data visualizations | (Mostly Clinical) Epidemiology with R</title>
  <meta name="description" content="This is an intermediate epidemiology book that focuses on clinical epidmeiology and its quantification using R. It stems from my belief that the learning of epidmeiologic principles is consolidated through hands on coding examples." />
  <meta name="generator" content="bookdown 0.21.6 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Data visualizations | (Mostly Clinical) Epidemiology with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is an intermediate epidemiology book that focuses on clinical epidmeiology and its quantification using R. It stems from my belief that the learning of epidmeiologic principles is consolidated through hands on coding examples." />
  <meta name="github-repo" content="brophyj/epi_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Data visualizations | (Mostly Clinical) Epidemiology with R" />
  
  <meta name="twitter:description" content="This is an intermediate epidemiology book that focuses on clinical epidmeiology and its quantification using R. It stems from my belief that the learning of epidmeiologic principles is consolidated through hands on coding examples." />
  

<meta name="author" content="James Brophy" />


<meta name="date" content="2021-01-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-statistical-software-r.html"/>
<link rel="next" href="measures-of-association-attributable-risk-epir-package.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
p.caption {
  color: #777;
  margin-top: 10px;
}
p code {
  white-space: inherit;
}
pre {
  word-break: normal;
  word-wrap: normal;
}
pre code {
  white-space: inherit;
}
FOO {
  font-weight: bold;
  color: red;
}


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">(Mostly Clinical) Epidemiology with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.0.1" data-path="intro.html"><a href="intro.html#r-packages-required-for-this-chapter"><i class="fa fa-check"></i><b>1.0.1</b> R packages required for this chapter</a></li>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#preface"><i class="fa fa-check"></i><b>1.1</b> Preface</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#pre"><i class="fa fa-check"></i><b>1.2</b> Prerequisites</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#my-general-philosophy-for-clinical-epidemiology"><i class="fa fa-check"></i><b>1.3</b> My general philosophy for clinical epidemiology</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#brief-excursions-into-quantification"><i class="fa fa-check"></i><b>1.4</b> Brief excursions into quantification</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#outline"><i class="fa fa-check"></i><b>1.5</b> Outline</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-statistical-software-r.html"><a href="introduction-to-statistical-software-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to statistical software - R</a><ul>
<li class="chapter" data-level="2.0.1" data-path="introduction-to-statistical-software-r.html"><a href="introduction-to-statistical-software-r.html#r-packages-required-for-this-chapter-1"><i class="fa fa-check"></i><b>2.0.1</b> R packages required for this chapter</a></li>
<li class="chapter" data-level="2.1" data-path="introduction-to-statistical-software-r.html"><a href="introduction-to-statistical-software-r.html#statistical-software---r"><i class="fa fa-check"></i><b>2.1</b> Statistical software - R</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-statistical-software-r.html"><a href="introduction-to-statistical-software-r.html#r---common-data-and-variable-manipulations"><i class="fa fa-check"></i><b>2.2</b> R - Common data and variable manipulations</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-statistical-software-r.html"><a href="introduction-to-statistical-software-r.html#rstudio---the-ide-for-r"><i class="fa fa-check"></i><b>2.3</b> RStudio - <strong>The</strong> IDE for R</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-statistical-software-r.html"><a href="introduction-to-statistical-software-r.html#r---more-than-a-statistical-program"><i class="fa fa-check"></i><b>2.4</b> R - More than a statistical program</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-statistical-software-r.html"><a href="introduction-to-statistical-software-r.html#r---general-public-license"><i class="fa fa-check"></i><b>2.5</b> R - General Public License</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-visualizations.html"><a href="data-visualizations.html"><i class="fa fa-check"></i><b>3</b> Data visualizations</a><ul>
<li class="chapter" data-level="3.0.1" data-path="data-visualizations.html"><a href="data-visualizations.html#r-packages-required-for-this-chapter-2"><i class="fa fa-check"></i><b>3.0.1</b> R packages required for this chapter</a></li>
<li class="chapter" data-level="3.1" data-path="data-visualizations.html"><a href="data-visualizations.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="data-visualizations.html"><a href="data-visualizations.html#why-is-data-visualization-important"><i class="fa fa-check"></i><b>3.2</b> Why is data visualization important?</a></li>
<li class="chapter" data-level="3.3" data-path="data-visualizations.html"><a href="data-visualizations.html#creating-an-effective-and-professional-appearing-graph"><i class="fa fa-check"></i><b>3.3</b> Creating an effective and professional appearing graph</a></li>
<li class="chapter" data-level="3.4" data-path="data-visualizations.html"><a href="data-visualizations.html#graphical-choices"><i class="fa fa-check"></i><b>3.4</b> Graphical choices</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="measures-of-association-attributable-risk-epir-package.html"><a href="measures-of-association-attributable-risk-epir-package.html"><i class="fa fa-check"></i><b>4</b> Measures of association &amp; attributable risk - epiR package</a><ul>
<li class="chapter" data-level="4.0.1" data-path="measures-of-association-attributable-risk-epir-package.html"><a href="measures-of-association-attributable-risk-epir-package.html#r-packages-required-for-this-chapter-3"><i class="fa fa-check"></i><b>4.0.1</b> R packages required for this chapter</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>5</b> Statistical inference</a><ul>
<li class="chapter" data-level="5.0.1" data-path="statistical-inference.html"><a href="statistical-inference.html#r-packages-required-for-this-chapter-4"><i class="fa fa-check"></i><b>5.0.1</b> R packages required for this chapter</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="design.html"><a href="design.html"><i class="fa fa-check"></i><b>6</b> Non-experimental designs</a><ul>
<li class="chapter" data-level="6.0.1" data-path="design.html"><a href="design.html#r-packages-required-for-this-chapter-5"><i class="fa fa-check"></i><b>6.0.1</b> R packages required for this chapter</a></li>
<li class="chapter" data-level="6.1" data-path="design.html"><a href="design.html#introduction-1"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="design.html"><a href="design.html#cohort-studies"><i class="fa fa-check"></i><b>6.2</b> Cohort studies</a></li>
<li class="chapter" data-level="6.3" data-path="design.html"><a href="design.html#case-control"><i class="fa fa-check"></i><b>6.3</b> Case control</a></li>
<li class="chapter" data-level="6.4" data-path="design.html"><a href="design.html#cross-sectional"><i class="fa fa-check"></i><b>6.4</b> Cross sectional</a></li>
<li class="chapter" data-level="6.5" data-path="design.html"><a href="design.html#miscellaneous-designs"><i class="fa fa-check"></i><b>6.5</b> Miscellaneous designs</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">(Mostly Clinical) Epidemiology with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-visualizations" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Data visualizations</h1>
<div id="r-packages-required-for-this-chapter-2" class="section level3">
<h3><span class="header-section-number">3.0.1</span> R packages required for this chapter</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="data-visualizations.html#cb1-1"></a><span class="kw">library</span>(dslabs)</span>
<span id="cb1-2"><a href="data-visualizations.html#cb1-2"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="data-visualizations.html#cb1-3"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb1-4"><a href="data-visualizations.html#cb1-4"></a><span class="kw">library</span>(magrittr)</span>
<span id="cb1-5"><a href="data-visualizations.html#cb1-5"></a><span class="kw">library</span>(gganimate)</span>
<span id="cb1-6"><a href="data-visualizations.html#cb1-6"></a><span class="kw">library</span>(scales)</span>
<span id="cb1-7"><a href="data-visualizations.html#cb1-7"></a><span class="kw">library</span>(transformr)</span></code></pre></div>
</div>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">3.1</span> Introduction</h2>
<p>There is a modern tendency for researchers to immediately present their results in the most complex and sophisticated manner. This is often seen as proof of their respectability and importance. However, a step wise approach that begins by presenting data in its rawest form of Tables and Graphs is both more logical and beneficial to understanding. In fact, there is are several historical examples of excellent visualizations involving epidemiology.</p>
<p>Although remembered as the mother of modern nursing, Florence Nightingale was an accomplished statistician too being the first female fellow of the Statistical Society of London (now Royal Statistical Society)<span class="citation">(<em>The Economist</em> <a href="#ref-econ" role="doc-biblioref">2013</a>)</span>. She was particularly innovative in presenting data visually as by this example published in her 1858 monograph, “Notes on matters affecting the health, efficiency and hospital administration of the British army”. The chart displays the causes of the deaths of soldiers during the Crimean war, divided into three categories: “Preventible or Mitigable Zymotic Diseases” (infectious diseases, including cholera and dysentery, coloured in blue), “wounds” (red) and “all other causes” (black). As with today’s pie charts, the area of each wedge is proportional to the figure it stands for, but it is the radius of each slice (the distance from the common centre to the outer edge) rather than the angle that is altered to achieve this. Her principal message—that even during periods of heavy fighting, such as November 1854, far more soldiers died from infection than from wounds—can be seen at a glance. It seems a fair bet that her talents as a data scientist contributed to her successful introduction of medical advances in military hospitals.</p>
<div class="figure"><span id="fig:unnamed-chunk-2"></span>
<img src="img/rose.png" alt="Classic epidemiology visualizations - Nightingale's Rose" width="100%" />
<p class="caption">
Figure 3.1: Classic epidemiology visualizations - Nightingale’s Rose
</p>
</div>
<p><a href="https://en.wikipedia.org/wiki/Charles_Joseph_Minard">Charles Minard’s</a> 1869 publication of a flow map of Napoleon’s Russian 1812 campaign has been called best statistical graphic ever drawn by <a href="https://en.wikipedia.org/wiki/Edward_Tufte">Edward Tufte</a> who is a preeminent 21st century statistician and pioneer in the field of data visualization. The figure shows 6 six types of data in two dimensions: the number of Napoleon’s troops; the distance traveled; temperature; latitude and longitude; direction of travel; and location relative to specific dates. The chart tells with painful clarity the atrocious losses associated with this campaign as an initial force of 422,000 saw only only 10,000 return. On the retrurn trip 50% of the forces were lost while crossing the Bérézina river under heavy attack. “C’est la Bérézina” is a French expression used to describe a total disaster.</p>
<div class="figure"><span id="fig:unnamed-chunk-3"></span>
<img src="img/minard.png" alt="Classic epidemiology visualizations - Napoleon’s Russian 1812 Campaign " width="100%" />
<p class="caption">
Figure 3.2: Classic epidemiology visualizations - Napoleon’s Russian 1812 Campaign
</p>
</div>
</div>
<div id="why-is-data-visualization-important" class="section level2">
<h2><span class="header-section-number">3.2</span> Why is data visualization important?</h2>
<p>Specifically, data visualizations can help<br />
* understand your data<br />
* understand basic concepts<br />
* emphasize a message<br />
* build trust with your audience<br />
* clarify your story for others<br />
* inform / influence their decisions<br />
* <strong>poor data visualizations can do the opposite!</strong></p>
<p>As an example of an uninspired visualization, consider the frequently observed bar plot which is a regular item in scientific publications. Contrast the lack of information provided by the commonly used bar plot format (Figure <a href="data-visualizations.html#fig:bad">3.3</a>) (avoiding any association with inferiority simply because it was created with Excel) with the additional data insights provided by simple histograms and box plots (Figure <a href="data-visualizations.html#fig:better">3.4</a>).</p>
<div class="figure" style="text-align: center"><span id="fig:bad"></span>
<img src="img/viz/bad.png" alt="Poor presentation - Bar plot" width="50%" />
<p class="caption">
Figure 3.3: Poor presentation - Bar plot
</p>
</div>
<div class="figure"><span id="fig:better"></span>
<img src="img/viz/better.png" alt="Improved presentation - histograms and box plots" width="100%" />
<p class="caption">
Figure 3.4: Improved presentation - histograms and box plots
</p>
</div>
<p>As another example of an uninspired plot, consider the pie chart which has been rightly criticized as being difficult to understand as we are effectively being asked to compared angles and the area subtended by them rather than simply making linear comparisons as in barplots. Notwithstanding the presence of Steve Jobs with the pie chart, which visualization is easiest to understand?</p>
<div style="display: flex;">
<div>
<div class="figure" style="text-align: left"><span id="fig:unnamed-chunk-4"></span>
<img src="img/viz/jobs.png" alt="Pie chart (with Steve Jobs)" width="100%" />
<p class="caption">
Figure 3.5: Pie chart (with Steve Jobs)
</p>
</div>
</div>
<div>
<div class="figure" style="text-align: right"><span id="fig:unnamed-chunk-5"></span>
<img src="03-visualizations_files/figure-html/unnamed-chunk-5-1.png" alt="Bar plot (without Steve Jobs)" width="50%" />
<p class="caption">
Figure 3.6: Bar plot (without Steve Jobs)
</p>
</div>
</div>
</div>
<div class="figure"><span id="fig:unnamed-chunk-6-1"></span>
<img src="img/viz/jobs.png" alt="Pie chart" width="50%" />
<p class="caption">
Figure 3.7: Pie chart
</p>
</div>
<div class="figure"><span id="fig:unnamed-chunk-6-2"></span>
<img src="03-visualizations_files/figure-html/unnamed-chunk-6-2.png" alt="Bar plot" width="50%" />
<p class="caption">
Figure 3.8: Bar plot
</p>
</div>
<p>In contrast, if you have any doubts about the power of excellent visualizations, you <strong>must</strong> watch this <a href="https://www.youtube.com/watch?v=Z8t4k0Q8e8Y">video</a> by <a href="https://en.wikipedia.org/wiki/Hans_Rosling">Hans Rosling</a>. Leaving aside his fabulous and infectious enthusiasm, (who wouldn’t want to be a global health data scientist after watching this), the knowledge transfer from his data visualizations is simply amazing.</p>
</div>
<div id="creating-an-effective-and-professional-appearing-graph" class="section level2">
<h2><span class="header-section-number">3.3</span> Creating an effective and professional appearing graph</h2>
<p>Here is a static image from Rosling’s video. It certainly is of professional quality. Can we reproduce it?</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-7"></span>
<img src="img/un_graph.png" alt="Gapminder data" width="50%" />
<p class="caption">
Figure 3.9: Gapminder data
</p>
</div>
<p>If the first plot we produce is of this quality, it will hopefully inspire us to realize what we can accomplish with data visualizations using <code>R</code>. While this may rightly not completely dispel the notion that a definitive learning curve is associated with<code>R</code>, it is certainly suggests it can be manageable. Here is the code that reproduces the graph.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="data-visualizations.html#cb2-1"></a><span class="co"># library(gapminder)</span></span>
<span id="cb2-2"><a href="data-visualizations.html#cb2-2"></a><span class="kw">library</span>(dslabs)</span>
<span id="cb2-3"><a href="data-visualizations.html#cb2-3"></a>dat &lt;-<span class="st"> </span>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2016</span>)</span>
<span id="cb2-4"><a href="data-visualizations.html#cb2-4"></a>un_graph &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x =</span> gdp, <span class="dt">y =</span> life_expectancy)) <span class="op">+</span></span>
<span id="cb2-5"><a href="data-visualizations.html#cb2-5"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">size =</span> population, <span class="dt">color =</span> continent), <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb2-6"><a href="data-visualizations.html#cb2-6"></a><span class="st">    </span><span class="kw">stat_smooth</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">log10</span>(x), <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">method =</span> <span class="st">&#39;gam&#39;</span>, <span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>) <span class="op">+</span></span>
<span id="cb2-7"><a href="data-visualizations.html#cb2-7"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;GDP per capita&quot;</span>) <span class="op">+</span></span>
<span id="cb2-8"><a href="data-visualizations.html#cb2-8"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Life expectancy at birth&quot;</span>) <span class="op">+</span></span>
<span id="cb2-9"><a href="data-visualizations.html#cb2-9"></a><span class="st">    </span><span class="kw">scale_size_area</span>(<span class="dt">guide =</span> <span class="ot">FALSE</span>, <span class="dt">max_size =</span> <span class="dv">15</span>) <span class="op">+</span></span>
<span id="cb2-10"><a href="data-visualizations.html#cb2-10"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>dollar) <span class="op">+</span></span>
<span id="cb2-11"><a href="data-visualizations.html#cb2-11"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Gapminder data from 2007&quot;</span>) <span class="op">+</span></span>
<span id="cb2-12"><a href="data-visualizations.html#cb2-12"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">caption =</span> <span class="st">&quot;Data from dslabs library&quot;</span>) <span class="op">+</span></span>
<span id="cb2-13"><a href="data-visualizations.html#cb2-13"></a><span class="st">    </span><span class="kw">scale_color_brewer</span>(<span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="op">+</span></span>
<span id="cb2-14"><a href="data-visualizations.html#cb2-14"></a><span class="st">    </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">12</span>, <span class="dt">base_family =</span> <span class="st">&quot;Georgia&quot;</span>)</span>
<span id="cb2-15"><a href="data-visualizations.html#cb2-15"></a></span>
<span id="cb2-16"><a href="data-visualizations.html#cb2-16"></a>un_graph</span></code></pre></div>
<pre><code>## Warning: Removed 185 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 185 rows containing missing values (geom_point).</code></pre>
<p><img src="03-visualizations_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="data-visualizations.html#cb5-1"></a><span class="co"># to save your figure</span></span>
<span id="cb5-2"><a href="data-visualizations.html#cb5-2"></a><span class="co"># ggsave(&quot;files/un_graph.png&quot;)</span></span></code></pre></div>
<p>The code can be understood as follows;<br />
1. We load the data which is available in both the <code>R</code> <code>Gapminder</code> and <code>dslabs</code> libraries (dslabs more complete).<br />
2. As data exists every 5 years from 1952, we have selectrd only 2007 data to match the static plot<br />
3. Graphing will use <code>ggplot</code> function from the <code>ggplot2</code> library<br />
4. The <code>ggplot</code> function first requires a data argument (in the form of a data frame)<br />
5. The next argument is <code>aes</code> for aesthetics and identifies the x and y variable names from the data frame<br />
6. In R any task such as identifying variable names can usually be accomplished by several ways (e.g. <code>names(gapminder)</code>, <code>str(gapminder)</code>, <code>glimpse(gapminder)</code>, <code>head(gapminder)</code>)<br />
7. Output is layered onto the graphical surface beginning here with the data points (<code>geom_points</code>) with color assigned according to <code>continent</code>, followed by a smoothed regression line (<code>stat_smooth</code>)<br />
8. Next purely aesthetic details such as a title, legends and a theme are added. As a beginner, and even as a more advanced user, it is not necessary to memorize all the possible formatting options as quick and accessible online resources are available to add these final refinements to your graphs (see <a href="https://ggplot2.tidyverse.org"></a></p>
<p>Using the <code>gganimate</code> package, a fully animated graph can be made with the code below
<img src="img/nations.gif" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="data-visualizations.html#cb6-1"></a><span class="co">### animated graph</span></span>
<span id="cb6-2"><a href="data-visualizations.html#cb6-2"></a>un_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(gapminder, <span class="kw">aes</span>(<span class="dt">x =</span> gdpPercap, <span class="dt">y =</span> lifeExp)) <span class="op">+</span></span>
<span id="cb6-3"><a href="data-visualizations.html#cb6-3"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">size =</span> pop, <span class="dt">color =</span> continent), <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb6-4"><a href="data-visualizations.html#cb6-4"></a><span class="st">    </span><span class="kw">stat_smooth</span>(<span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">log10</span>(x), <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">method =</span> <span class="st">&#39;gam&#39;</span>, <span class="dt">linetype=</span><span class="st">&quot;dotted&quot;</span>) <span class="op">+</span></span>
<span id="cb6-5"><a href="data-visualizations.html#cb6-5"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;GDP per capita&quot;</span>) <span class="op">+</span></span>
<span id="cb6-6"><a href="data-visualizations.html#cb6-6"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Life expectancy at birth&quot;</span>) <span class="op">+</span></span>
<span id="cb6-7"><a href="data-visualizations.html#cb6-7"></a><span class="st">    </span><span class="kw">scale_size_area</span>(<span class="dt">guide =</span> <span class="ot">FALSE</span>, <span class="dt">max_size =</span> <span class="dv">15</span>) <span class="op">+</span></span>
<span id="cb6-8"><a href="data-visualizations.html#cb6-8"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>dollar) <span class="op">+</span></span>
<span id="cb6-9"><a href="data-visualizations.html#cb6-9"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Gapminder data from 2007&quot;</span>) <span class="op">+</span></span>
<span id="cb6-10"><a href="data-visualizations.html#cb6-10"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">caption =</span> <span class="st">&quot;Data from gapminder library&quot;</span>) <span class="op">+</span></span>
<span id="cb6-11"><a href="data-visualizations.html#cb6-11"></a><span class="st">    </span><span class="kw">scale_color_brewer</span>(<span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="op">+</span></span>
<span id="cb6-12"><a href="data-visualizations.html#cb6-12"></a><span class="st">    </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">12</span>, <span class="dt">base_family =</span> <span class="st">&quot;Georgia&quot;</span>) <span class="op">+</span></span>
<span id="cb6-13"><a href="data-visualizations.html#cb6-13"></a><span class="st">    </span><span class="co"># gganimate code</span></span>
<span id="cb6-14"><a href="data-visualizations.html#cb6-14"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;{frame_time}&quot;</span>) <span class="op">+</span></span>
<span id="cb6-15"><a href="data-visualizations.html#cb6-15"></a><span class="st">    </span><span class="kw">transition_time</span>(year) <span class="op">+</span></span>
<span id="cb6-16"><a href="data-visualizations.html#cb6-16"></a><span class="st">    </span><span class="kw">ease_aes</span>(<span class="st">&quot;linear&quot;</span>) <span class="op">+</span></span>
<span id="cb6-17"><a href="data-visualizations.html#cb6-17"></a><span class="st">    </span><span class="kw">enter_fade</span>() <span class="op">+</span></span>
<span id="cb6-18"><a href="data-visualizations.html#cb6-18"></a><span class="st">    </span><span class="kw">exit_fade</span>()</span>
<span id="cb6-19"><a href="data-visualizations.html#cb6-19"></a></span>
<span id="cb6-20"><a href="data-visualizations.html#cb6-20"></a><span class="kw">animate</span>(un_plot)</span></code></pre></div>
<p>While we are considering this international data source, let’s see how you do with a simple quiz.<br />
Q1. Which countries in each pair have the highest child mortality (2015)?<br />
Q2. Which pairs of countries are most similar?<br />
* Sri Lanka or Turkey<br />
* Poland or South Korea<br />
* Malaysia or Russia<br />
* Pakistan or Vietnam<br />
* Thailand or South Africa</p>
<p>Now as it is unlikely that you have actual knowledge of country specific mortality data, most individuals will attempt to employ some heuristic to help answer the question. One such heuristic would say <em>“European countries lower child mortality than non-European”</em>. Following that heuristic, our answers might be: Sri Lanka, South Korea, Malaysia with Pakistan or Vietnam and Thailand or South Africa as non-European countries being the most similar. Fortunately we can do better by analyzing the <code>gapminder</code> dataset</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="data-visualizations.html#cb7-1"></a><span class="co">## A bit of code</span></span>
<span id="cb7-2"><a href="data-visualizations.html#cb7-2"></a><span class="kw">library</span>(dslabs) <span class="co">#source of gapminder data</span></span>
<span id="cb7-3"><a href="data-visualizations.html#cb7-3"></a><span class="kw">data</span>(gapminder)</span>
<span id="cb7-4"><a href="data-visualizations.html#cb7-4"></a></span>
<span id="cb7-5"><a href="data-visualizations.html#cb7-5"></a><span class="co"># write a simple function for the comparison between 2 countries</span></span>
<span id="cb7-6"><a href="data-visualizations.html#cb7-6"></a>compare_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="cf">function</span>(x,y){</span>
<span id="cb7-7"><a href="data-visualizations.html#cb7-7"></a>    gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> &quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>country <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(x, y)) <span class="op">%&gt;%</span></span>
<span id="cb7-8"><a href="data-visualizations.html#cb7-8"></a><span class="st">    </span><span class="kw">select</span>(country, infant_mortality)</span>
<span id="cb7-9"><a href="data-visualizations.html#cb7-9"></a>}</span>
<span id="cb7-10"><a href="data-visualizations.html#cb7-10"></a></span>
<span id="cb7-11"><a href="data-visualizations.html#cb7-11"></a><span class="kw">compare_2</span>(<span class="st">&quot;Sri Lanka&quot;</span>, <span class="st">&quot;Turkey&quot;</span>)</span></code></pre></div>
<pre><code>##     country infant_mortality
## 1 Sri Lanka              8.4
## 2    Turkey             11.6</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="data-visualizations.html#cb9-1"></a><span class="kw">compare_2</span>(<span class="st">&quot;Poland&quot;</span>, <span class="st">&quot;South Korea&quot;</span>)</span></code></pre></div>
<pre><code>##       country infant_mortality
## 1 South Korea              2.9
## 2      Poland              4.5</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="data-visualizations.html#cb11-1"></a><span class="kw">compare_2</span>(<span class="st">&quot;Malaysia&quot;</span>, <span class="st">&quot;Russia&quot;</span>)</span></code></pre></div>
<pre><code>##    country infant_mortality
## 1 Malaysia              6.0
## 2   Russia              8.2</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="data-visualizations.html#cb13-1"></a><span class="kw">compare_2</span>(<span class="st">&quot;Pakistan&quot;</span>, <span class="st">&quot;Vietnam&quot;</span>)</span></code></pre></div>
<pre><code>##    country infant_mortality
## 1 Pakistan             65.8
## 2  Vietnam             17.3</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="data-visualizations.html#cb15-1"></a><span class="kw">compare_2</span>(<span class="st">&quot;Thailand&quot;</span>, <span class="st">&quot;South Africa&quot;</span>)</span></code></pre></div>
<pre><code>##        country infant_mortality
## 1 South Africa             33.6
## 2     Thailand             10.5</code></pre>
<p>If we were merely ignorant we might have expected to get 2.5 answers right but it seems if we followed our heuristic we would have got 0 right answers implying we are more than simply ignorant but actually misinformed! We can use the same dataset to query our heuristic about better survival in European countries.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="data-visualizations.html#cb17-1"></a>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(continent <span class="op">==</span><span class="st"> &quot;Asia&quot;</span> <span class="op">|</span><span class="st"> </span>continent <span class="op">==</span><span class="st"> &quot;Europe&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb17-2"><a href="data-visualizations.html#cb17-2"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1962</span>, <span class="dv">1980</span>, <span class="dv">1990</span>, <span class="dv">2012</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb17-3"><a href="data-visualizations.html#cb17-3"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(fertility, infant_mortality, <span class="dt">color=</span> continent)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb17-4"><a href="data-visualizations.html#cb17-4"></a><span class="st">    </span><span class="kw">facet_grid</span>(<span class="dt">cols =</span> <span class="kw">vars</span>(year)) <span class="op">+</span></span>
<span id="cb17-5"><a href="data-visualizations.html#cb17-5"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb17-6"><a href="data-visualizations.html#cb17-6"></a><span class="st">    </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">200</span>) <span class="op">+</span></span>
<span id="cb17-7"><a href="data-visualizations.html#cb17-7"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Infant mortality over time&quot;</span>) <span class="op">+</span></span>
<span id="cb17-8"><a href="data-visualizations.html#cb17-8"></a><span class="st">    </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 53 rows containing missing values (geom_point).</code></pre>
<p><img src="03-visualizations_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="data-visualizations.html#cb19-1"></a>gapminder <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(continent <span class="op">==</span><span class="st"> &quot;Asia&quot;</span> <span class="op">|</span><span class="st"> </span>continent <span class="op">==</span><span class="st"> &quot;Europe&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb19-2"><a href="data-visualizations.html#cb19-2"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1962</span>, <span class="dv">1980</span>, <span class="dv">1990</span>, <span class="dv">2012</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb19-3"><a href="data-visualizations.html#cb19-3"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(fertility, life_expectancy, <span class="dt">color=</span> continent)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-4"><a href="data-visualizations.html#cb19-4"></a><span class="st">    </span><span class="kw">facet_grid</span>(<span class="dt">cols =</span> <span class="kw">vars</span>(year)) <span class="op">+</span></span>
<span id="cb19-5"><a href="data-visualizations.html#cb19-5"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-6"><a href="data-visualizations.html#cb19-6"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Life expectancy over time&quot;</span>) <span class="op">+</span></span>
<span id="cb19-7"><a href="data-visualizations.html#cb19-7"></a><span class="st">    </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="03-visualizations_files/figure-html/unnamed-chunk-12-2.png" width="672" />
These graphs show that the heuristic of improved infant and overall life expectancy among European countries was true 60 years ago but is no longer today’s truth. This underlines the need to continually question our baseline assumptions.</p>
</div>
<div id="graphical-choices" class="section level2">
<h2><span class="header-section-number">3.4</span> Graphical choices</h2>
<p>Visualizations play an important role in understanding the data, exploring the data, and interpreting the data.<br />
The most common visualization methods are:<br />
* Histograms<br />
* Scatterplots<br />
* Boxplots<br />
* Survival curves (Kaplan Meier)<br />
* Heatmaps and many more</p>
<p>A graph can provide a quick interpretation of the data and orient more in depth analyses.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-13"></span>
<img src="img/graphs.png" alt="Data visualization -&gt; Quick understanding of data" width="1000%" />
<p class="caption">
Figure 3.10: Data visualization -&gt; Quick understanding of data
</p>
</div>
<p>Consider this story from the <a href="https://www.nytimes.com/2011/02/19/nyregion/19schools.html?searchResultPosition=1">New York Times</a> about the scoring of high school leaving exams where 65 is the passing grade. A histogram of the grades shows important abnormalities with 5 times more students scoring exactly 65 than those scoring between 61-64, leaving a suspicion that grading may not be completely unbiased. Simply reporting the mean, median, standard deviations, percentage passing or any other numerical summary would not have detected the strangeness of the data.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-14"></span>
<img src="img/hs_grades.png" alt="Histogram of grades" width="100%" />
<p class="caption">
Figure 3.11: Histogram of grades
</p>
</div>
<p>Graphs can also be combined to provide further insights into the data. The following is a graph from the excellent book <a href="https://github.com/dspiegel29/ArtofStatistics">The Art of Statistics</a> by David Speigelhalter that shows the gender and timing of the 215 confirmed victims of the mass murderer, Dr. Harold Shipman.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-15"></span>
<img src="img/shipman.png" alt="Murder victims" width="100%" />
<p class="caption">
Figure 3.12: Murder victims
</p>
</div>
<p>Here a basic scatter plot has been combined with marginal histograms. This enables a quick appreciation that the victims were<br />
1. more often women<br />
2. mostly older but some younger victims in more recent times<br />
3. a gap occured around 1992<br />
4. there were increased murders in later years</p>
<p>Fortunately, most datasets that we will examine are not this gruesome.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-econ">
<p><em>The Economist</em>. 2013. “Worth a Thousand Words,” October 7, 2013. <a href="https://www.economist.com/christmas-specials/2013/10/07/worth-a-thousand-words">https://www.economist.com/christmas-specials/2013/10/07/worth-a-thousand-words</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-statistical-software-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="measures-of-association-attributable-risk-epir-package.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-clinepi.pdf", "bookdown-clinepi.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
